<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>D.C </title>
<meta name="description" content="人类世界真是太有趣了" />
<link rel="shortcut icon" href="https://skrupellose.github.io/favicon.ico?v=1574085155362">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link href="https://cdn.remixicon.com/releases/v1.3.1/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">

<link rel="stylesheet" href="https://skrupellose.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="D.C  - Atom Feed" href="https://skrupellose.github.io/atom.xml">



  </head>
  <body>
    <div id="app" class="main px-4 flex flex-col lg:flex-row">
      <div id="sidebar" class="sidebar-wrapper lg:static lg:w-1/4">
  <div class="lg:sticky top-0">
    <div class="sidebar-content">
      <div class="flex lg:block p-4 lg:px-0 items-center fixed lg:static lg:block top-0 right-0 left-0 bg-white z-50">
        <i class="remixicon-menu-2-line lg:mt-4 text-2xl cursor-pointer animated fadeIn" onclick="openMenu()"></i>
        <a href="https://skrupellose.github.io">
          <img class="animated fadeInLeft avatar rounded-lg mx-4 lg:mt-32 lg:mx-0 mt-0 lg:w-24 lg:h-24 w-12 w-12" src="https://skrupellose.github.io/images/avatar.png?v=1574085155362" alt="">
        </a>
        <h1 class="animated fadeInLeft lg:text-4xl font-extrabold lg:mt-8 mt-0 text-xl" style="animation-delay: 0.2s">D.C </h1>
      </div>
      
        <div class="animated fadeInLeft" style="animation-delay: 0.4s">
          <p class="my-4 text-gray-600 font-light hidden lg:block">
            文章目录
          </p>
          <div class="toc-container hidden lg:block">
            <ul class="markdownIt-TOC">
<li><a href="#%E4%B8%80-fetch%E7%9A%84%E7%94%A8%E6%B3%95">一、fetch的用法</a>
<ul>
<li><a href="#11-fetch%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0">1.1 fetch请求参数</a></li>
<li><a href="#12-get%E8%AF%B7%E6%B1%82">1.2 GET请求</a></li>
<li><a href="#13-delete%E8%AF%B7%E6%B1%82">1.3 DELETE请求</a></li>
<li><a href="#14-post%E8%AF%B7%E6%B1%82">1.4 POST请求</a></li>
<li><a href="#15-put%E8%AF%B7%E6%B1%82">1.5 PUT请求</a></li>
</ul>
</li>
<li><a href="#%E4%BA%8C-axios">二、axios</a>
<ul>
<li><a href="#21-%E7%94%A8%E6%B3%95">2.1 用法</a></li>
<li><a href="#22-get%E8%AF%B7%E6%B1%82">2.2 get请求</a></li>
<li><a href="#23-delete%E8%AF%B7%E6%B1%82">2.3 delete请求</a></li>
<li><a href="#24-post%E8%AF%B7%E6%B1%82">2.4 post请求</a></li>
<li><a href="#25-put%E8%AF%B7%E6%B1%82">2.5 put请求</a></li>
<li><a href="#26-%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94%E6%8B%A6%E6%88%AA">2.6 请求和响应拦截</a></li>
<li><a href="#27-axios%E5%93%8D%E5%BA%94%E7%BB%93%E6%9E%9C">2.7 axios响应结果</a></li>
<li><a href="#28-axios%E5%92%8Casyncawait%E7%9A%84%E8%81%94%E7%94%A8">2.8 axios和async/await的联用</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      
    </div>
  </div>
</div>

<div class="menu-container">
  <i class="remixicon-arrow-left-line text-2xl cursor-pointer animated fadeIn close-menu-btn" onclick="closeMenu()"></i>
  <div>
    
      
        <a href="/" class="menu" style="animation-delay: 0s">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu" style="animation-delay: 0.2s">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu" style="animation-delay: 0.4s">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu" style="animation-delay: 0.6000000000000001s">
          关于
        </a>
      
    
      
        <a href="https://skrupellose.github.io/post/zai-xian-shi-li/" class="menu" style="animation-delay: 0.8s">
          在线实例
        </a>
      
    
  </div>
  <div class="site-footer">
    <div class="py-4 text-gray-700">人间烟火气，最抚凡人心</div>
    <a class="rss" href="https://skrupellose.github.io/atom.xml" target="_blank">RSS</a>
  </div>
</div>
<div class="mask" onclick="closeMenu()">
</div>
      <div class="content-wrapper py-32 lg:p-8 lg:w-3/4 post-detail animated fadeIn">
        <h1 class="text-3xl font-bold lg:mt-16">fetch和axios的上手使用</h1>
        <div class="text-sm text-gray-700 lg:my-8">
          2019-11-14 / 5 min read
        </div>
        
          <img class="post-feature-image rounded-lg mx-auto my-4" src="http://pic.netbian.com/uploads/allimg/190917/221916-1568729956d942.jpg" alt="">
        
        <div class="post-content yue">
          <p>复(xue)习一下<code>fetch</code>和<code>axios</code>的用法</p>
<h1 id="一-fetch的用法">一、fetch的用法</h1>
<p>直接贴demo了</p>
<pre><code>      fetch(&quot;url&quot;).then(data =&gt; {
        return data.text().then(res =&gt; {
          console.log(res);
        });
      });
</code></pre>
<ul>
<li>要获取数据首先要调用<code>text()</code>方法或者<code>json()</code>方法</li>
<li><code>data.text()/data.json()</code>返回的是<code>promise</code>对象，用<code>.then()</code>处理之后得到的才是结果</li>
<li><code>text()</code>返回结果为字符串</li>
<li><code>json()</code>返回结果为json类型</li>
</ul>
<h2 id="11-fetch请求参数">1.1 fetch请求参数</h2>
<ul>
<li><code>method(String)</code>:http请求方法，默认为<code>GET(GET、POST、PUT、DELETE)</code></li>
<li><code>body(String)</code>:http的请求参数</li>
<li><code>header(Object)</code>:http的请求头，默认为{}</li>
</ul>
<h2 id="12-get请求">1.2 GET请求</h2>
<pre><code>
      // url传递参数
      fetch('url?id=123',{
        method: 'get'
      }).then(data =&gt; {
        return data.text()
        .then(res =&gt; {
          console.log(res);
        })
      })
      // Restful形式的url传递参数
      fetch('url/123',{
        method: 'get'
      }).then(data =&gt; {
        return data.text()
        .then(res =&gt; {
          console.log(res);
        })
      })
</code></pre>
<h2 id="13-delete请求">1.3 DELETE请求</h2>
<p>✊偷个懒 只需把<code>method</code>换成<code>delete</code>即可</p>
<h2 id="14-post请求">1.4 POST请求</h2>
<pre><code>  //传统参数传递
  fetch('url',{
    method: 'post',
    body: 'name=abc&amp;passwd=123',
    headers: {
      'Content-type': 'application/x-www-form-unlencoded',
    }//请求头必须设置否则body里的数据传不到后台去
  }).then(data =&gt; {
    return data.text()
    .then(res =&gt; {
      console.log(res);
    })
  })

  //json形式参数传递
  fetch('url',{
    method: 'post',
    body: JSON.stringify({
      name:&quot;abc&quot;,
      passwd:&quot;123&quot;
    }),
    headers: {
      'Content-type': 'application/json',
    }//请求头必须设置否则body里的数据传不到后台去
  }).then(data =&gt; {
    return data.text()
    .then(res =&gt; {
      console.log(res);
    })
  })
</code></pre>
<h2 id="15-put请求">1.5 PUT请求</h2>
<pre><code>      fetch('url/456',{
        method: 'put',
        body: JSON.stringify({
          name:&quot;abc&quot;,
          passwd:&quot;123&quot;
        }),
        headers: {
          'Content-type': 'application/json',
        }
      }).then(data =&gt; {
        return data.text()
        .then(res =&gt; {
          console.log(res);
        })
      })
      // 把put的值通过url的Restful形式传过去
</code></pre>
<h1 id="二-axios">二、axios</h1>
<h2 id="21-用法">2.1 用法</h2>
<pre><code>      axios.get('url')
      .then(res =&gt; {
        console.log(res.data)
        // 需要注意的是使用axios请求数据后.then()返回的对象除去我们想要的数据
        // 之外还有其他的数据，所以当我们需要拿到想要的数据的时候要使用data属性来获取
      })
</code></pre>
<h2 id="22-get请求">2.2 get请求</h2>
<pre><code>      // 1.通过url传递
      axios.get('url?id=123')
      .then(res =&gt; {
        console.log(res.data)
      })
      // 2.通过params属性传递
      axios.get('url',{
        params:{
          id: 123
        }
      })
      .then(res =&gt; {
        console.log(res.data)
      })

</code></pre>
<h2 id="23-delete请求">2.3 delete请求</h2>
<p>继续偷个懒，<code>delete</code>方式只需要把<code>ge</code>t换成<code>delete</code>即可</p>
<h2 id="24-post请求">2.4 post请求</h2>
<pre><code>  // 通过选项来传递参数默认传递的是json格式的数据
      axios.post('url',{
        name: &quot;yy&quot;,
        age: 16
      })//通过这种传到后台的数据是json格式
      .then(res =&gt;{
        console.log(res.data)
      })

      // 通过URLSearchParams传递参数
      const params = new URLSearchParams();
      params.append('name','abc');
      params.append('age','16');
      axios.post('url', params)
      .then(res =&gt; {
        console.log(res.data)
      })
</code></pre>
<h2 id="25-put请求">2.5 put请求</h2>
<pre><code>      axios.post('url/123',{
        name: &quot;yy&quot;,
        age: 16
      })//通过这种传到后台的数据是json格式
      .then(res =&gt;{
        console.log(res.data)
      })
</code></pre>
<h2 id="26-请求和响应拦截">2.6 请求和响应拦截</h2>
<pre><code>      // 请求拦截 发出请求数据之前进行一些配置和处理
      axios.interceptors.request.use(config =&gt;{
        ... //一些操作代码
        return config;
      })

      // 响应拦截 获取数据之前对数据进行一些处理
      axios.interceptors.response.use(res =&gt;{
        ... //一些操作代码
        return res;
      })

</code></pre>
<h2 id="27-axios响应结果">2.7 axios响应结果</h2>
<p>响应结果被包装成一个对象<br>
里面的主要属性：<br>
-<code>data</code>：实际响应回的数据<br>
-<code>headers</code>： 响应头信息</p>
<ul>
<li><code>status</code>：响应状态码</li>
<li><code>statusText</code>：响应状态信息</li>
</ul>
<h2 id="28-axios和asyncawait的联用">2.8 axios和async/await的联用</h2>
<pre><code>      async function get_(){
        let res = await axios.get('url');
        console.log(res.data)
      }
      get_() //data

      axios.get('url')
      .then(res =&gt; {
        console.log(res.data)
      })
</code></pre>
<p><code>then()</code>方法参数中的函数返回值:</p>
<ol>
<li>返回<code>promise</code>对象 返回的对象会调用下一个<code>then</code></li>
<li>返回普通值，会被直接传递给下一个<code>then()</code>的函数中充当参数</li>
</ol>
<p>或是：后面的请求需要前一个请求返回的结果作为参数，可以这么写提高代码可读性</p>
<pre><code>        async function test(){
          let res1 = await axios.get('url1')
          let res2 = await axios.get('url2?info=' + res1.data)
          return rest2
        }
        test().then(res =&gt; {
          console.log(res);
        })
</code></pre>
<p>补充：我们还可以新建一个<code>axios</code>实例对象来进行一些配置</p>
<pre><code>const $axios = axios.create({
  // 设置超时时间
  timeout: 30000,
  // 基础url，会在请求url中自动添加前置链接
  baseURL: &quot;url&quot;
});
</code></pre>
<p>这样我们在后面使用<code>axios</code>发送请求的时候就不用写那么长的url了</p>

        </div>

        
          <a class="animated fadeInUp p-2 items-center text-sm text-gray-700 border hover:bg-gray-300 leading-none rounded-full flex lg:inline-flex m-4 " href="https://skrupellose.github.io/tag/4tSxaGaLB">
            <span class="flex-auto">axios</span>
          </a>
        
          <a class="animated fadeInUp p-2 items-center text-sm text-gray-700 border hover:bg-gray-300 leading-none rounded-full flex lg:inline-flex m-4 " href="https://skrupellose.github.io/tag/JF7ARvJKD">
            <span class="flex-auto">fetch</span>
          </a>
        
          <a class="animated fadeInUp p-2 items-center text-sm text-gray-700 border hover:bg-gray-300 leading-none rounded-full flex lg:inline-flex m-4 " href="https://skrupellose.github.io/tag/qZAGnAXQq">
            <span class="flex-auto">js</span>
          </a>
        


        <div class="flex justify-between py-8">
          
            <div class="prev-post">
              <a href="https://skrupellose.github.io/post/suan-fa-ti-shu-zu-1">
                <h3 class="post-title">
                  <i class="remixicon-arrow-left-line"></i>
                  算法题--数组(1)
                </h3>
              </a>
            </div>
          

          
            <div class="next-post">
              <a href="https://skrupellose.github.io/post/shen-qian-kao-bei-xiao-zong-jie">
                <h3 class="post-title">
                  深浅拷贝小总结
                  <i class="remixicon-arrow-right-line"></i>
                </h3>
              </a>
            </div>
          
        </div>

        

      </div>
    </div>

    <script src="https://skrupellose.github.io/media/prism.js"></script>  
<script>

Prism.highlightAll()

let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

// This should probably be throttled.
// Especially because it triggers during smooth scrolling.
// https://lodash.com/docs/4.17.10#throttle
// You could do like...
// window.addEventListener("scroll", () => {
//    _.throttle(doThatStuff, 100);
// });
// Only not doing it here to keep this Pen dependency-free.

window.addEventListener("scroll", event => {
  let fromTop = window.scrollY;

  mainNavLinks.forEach((link, index) => {
    let section = document.getElementById(decodeURI(link.hash).substring(1));
    let nextSection = null
    if (mainNavLinks[index + 1]) {
      nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
    }
    if (section.offsetTop <= fromTop) {
      if (nextSection) {
        if (nextSection.offsetTop > fromTop) {
          link.classList.add("current");
        } else {
          link.classList.remove("current");    
        }
      } else {
        link.classList.add("current");
      }
    } else {
      link.classList.remove("current");
    }
  });
});


document.addEventListener("DOMContentLoaded", function() {
  var lazyImages = [].slice.call(document.querySelectorAll(".post-feature-image.lazy"));

  if ("IntersectionObserver" in window) {
    let lazyImageObserver = new IntersectionObserver(function(entries, observer) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          let lazyImage = entry.target
          lazyImage.style.backgroundImage = `url(${lazyImage.dataset.bg})`
          lazyImage.classList.remove("lazy")
          lazyImageObserver.unobserve(lazyImage)
        }
      });
    });

    lazyImages.forEach(function(lazyImage) {
      lazyImageObserver.observe(lazyImage)
    })
  } else {
    // Possibly fall back to a more compatible method here
  }
});

const menuContainer = document.querySelector('.menu-container')
const menus = document.querySelectorAll('.menu-container .menu')
const mask = document.querySelector('.mask')
const contentWrapper = document.querySelector('.content-wrapper')
const latestArticle = document.querySelector('.latest-article')
const readMore = document.querySelector('.read-more')
const indexPage = document.querySelector('.index-page')

const isHome = location.pathname === '/'
if (latestArticle) {
  latestArticle.style.display = isHome ? 'block' : 'none'
  readMore.style.display = isHome ? 'block' : 'none'
  indexPage.style.display = isHome ? 'none' : 'block'
}

const openMenu = () => {
  menuContainer.classList.add('open')
  menus.forEach(menu => {
    menu.classList.add('animated', 'fadeInLeft')
  })
  mask.classList.add('open')
  contentWrapper.classList.add('is-second')
}

const closeMenu = () => {
  menuContainer.classList.remove('open')
  menus.forEach(menu => {
    menu.classList.remove('animated', 'fadeInLeft')
  })
  mask.classList.remove('open')
  contentWrapper.classList.remove('is-second')
}
</script>
  
  </body>
</html>
